# -------------------------------------------------------------------------
# default/alert_actions.conf
#
# Sandfly Security for Splunk App
#
# Purpose:
# - Define custom alert actions for Sandfly detections and notifications
# - Support external notifications and integrations
# - No mutation of Sandfly data
#
# Design rules:
# - Alert actions are OPTIONAL
# - Disabled by default
# - Read-only use of search results
# - Safe for Splunk Cloud and AppInspect
# -------------------------------------------------------------------------

###############################################################################
# EMAIL ALERT ACTION
###############################################################################

[sandfly_email_alert]
is_custom = 1
label = Sandfly Email Alert
description = Send email notification for Sandfly alerts and notifications
icon_path = appIcon.png
payload_format = json
disabled = 0

param.to =
param.cc =
param.subject = [Sandfly Alert] $name$
param.message = Sandfly Alert Triggered\n\nAlert Name: $name$\nTrigger Time: $trigger_time$\nResults Matched: $result.count$\n\nDetails:\n$result._raw$
param.include_results = 1
param.include_link = 1
param.priority = normal

###############################################################################
# WEBHOOK ALERT ACTION
###############################################################################

[sandfly_webhook_alert]
is_custom = 1
label = Sandfly Webhook Alert
description = Send Sandfly alert payload to external systems (SOAR, Slack, Teams, SIEM)
icon_path = appIcon.png
payload_format = json
disabled = 0

param.webhook_url =
param.method = POST
param.content_type = application/json
param.include_results = 1
param.custom_headers =
param.verify_ssl = 1
param.timeout = 30

param.payload_template = {
  "alert_name": "$name$",
  "trigger_time": "$trigger_time$",
  "results_count": "$result.count$",
  "search_name": "$search_name$",
  "app": "$app$",
  "owner": "$owner$",
  "results_link": "$results_link$",
  "notification_id": "$result.id$",
  "severity": "$result.severity$",
  "state": "$result.state$",
  "type": "$result.type$",
  "source": "Sandfly Security"
}

###############################################################################
# SCRIPT ALERT ACTION
###############################################################################

[sandfly_script_alert]
is_custom = 1
label = Sandfly Script Alert
description = Execute a custom script for Sandfly alerts (ticketing, SOAR, automation)
icon_path = appIcon.png
payload_format = json
disabled = 0

param.script_name = sandfly_alert_script.py
param.script_args =
param.pass_payload = 1

###############################################################################
# SERVICENOW INTEGRATION
###############################################################################

[sandfly_snow_alert]
is_custom = 1
label = Sandfly ServiceNow Alert
description = Create ServiceNow incidents for critical Sandfly alerts
icon_path = appIcon.png
payload_format = json
disabled = 0

param.snow_url =
param.snow_user =
param.snow_password =
param.incident_category = Security
param.incident_subcategory = Host Security
param.incident_priority = 3
param.incident_short_description = [Sandfly] Alert: $name$
param.incident_description = Sandfly alert triggered.\n\nAlert: $name$\nSeverity: $result.severity$\nState: $result.state$\nType: $result.type$\n\nRaw Event:\n$result._raw$

###############################################################################
# PAGERDUTY INTEGRATION
###############################################################################

[sandfly_pagerduty_alert]
is_custom = 1
label = Sandfly PagerDuty Alert
description = Trigger PagerDuty incidents for high-impact Sandfly alerts
icon_path = appIcon.png
payload_format = json
disabled = 0

param.routing_key =
param.severity = error
param.dedup_key = sandfly-$result.id$
param.event_action = trigger
param.summary = Sandfly Alert: $name$
param.source = Splunk Sandfly App
param.component = $result.type$
param.group = host-security
param.class = sandfly-alert

###############################################################################
# END OF FILE
###############################################################################
