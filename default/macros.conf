# -------------------------------------------------------------------------
# macros.conf
#
# Sandfly Security for Splunk App
#
# Purpose:
# - Provide reusable, read-only SPL macros for Sandfly datasets
# - Standardize searches across dashboards, reports, and saved searches
# - Avoid duplicated SPL logic
# - Preserve raw event integrity (no eval-based mutation of _raw)
#
# Design rules:
# - Macros are SEARCH-TIME ONLY
# - No macros perform writes, lookups, or enrichment
# - Macros must be safe for Splunk Cloud
# - Macros must not assume a specific index unless explicitly required
#
# Naming convention:
#   sandfly_<domain>_<purpose>
#
# -------------------------------------------------------------------------

###############################################################################
# Base macros
###############################################################################

[sandfly_index]
definition = index=sandfly
iseval = 0

[sandfly_all_events]
definition = index=sandfly sourcetype=sandfly:*
iseval = 0

###############################################################################
# Core domain macros
###############################################################################

[sandfly_alarms]
definition = index=sandfly sourcetype=sandfly:alarms
iseval = 0

[sandfly_hosts]
definition = index=sandfly sourcetype=sandfly:hosts
iseval = 0

[sandfly_sandflies]
definition = index=sandfly sourcetype=sandfly:sandflies
iseval = 0

[sandfly_results]
definition = index=sandfly sourcetype=sandfly:results
iseval = 0

[sandfly_results_timeline]
definition = index=sandfly sourcetype=sandfly:results:timeline
iseval = 0

[sandfly_resultprofiles]
definition = index=sandfly sourcetype=sandfly:resultprofiles
iseval = 0

###############################################################################
# SSH Hunter macros
###############################################################################

[sandfly_sshhunter_summary]
definition = index=sandfly sourcetype=sandfly:sshhunter:summary
iseval = 0

[sandfly_sshhunter_minisummary]
definition = index=sandfly sourcetype=sandfly:sshhunter:minisummary
iseval = 0

[sandfly_sshhunter_keys]
definition = index=sandfly sourcetype=sandfly:sshhunter:keys
iseval = 0

[sandfly_sshhunter_users]
definition = index=sandfly sourcetype=sandfly:sshhunter:users
iseval = 0

[sandfly_sshhunter_hosts]
definition = index=sandfly sourcetype=sandfly:sshhunter:hosts
iseval = 0

###############################################################################
# Host detail inventory macros
###############################################################################

[sandfly_hosts_kernelmodules]
definition = index=sandfly sourcetype=sandfly:hosts:kernelmodules
iseval = 0

[sandfly_hosts_services]
definition = index=sandfly sourcetype=sandfly:hosts:services
iseval = 0

[sandfly_hosts_processes]
definition = index=sandfly sourcetype=sandfly:hosts:processes
iseval = 0

[sandfly_hosts_users]
definition = index=sandfly sourcetype=sandfly:hosts:users
iseval = 0

[sandfly_hosts_listeners]
definition = index=sandfly sourcetype=sandfly:hosts:listeners
iseval = 0

[sandfly_hosts_scheduledtasks]
definition = index=sandfly sourcetype=sandfly:hosts:scheduledtasks
iseval = 0

[sandfly_hosts_lastlog]
definition = index=sandfly sourcetype=sandfly:hosts:lastlog
iseval = 0

[sandfly_hosts_loggedinusers]
definition = index=sandfly sourcetype=sandfly:hosts:loggedinusers
iseval = 0

###############################################################################
# Identity, credentials, and users
###############################################################################

[sandfly_users]
definition = index=sandfly sourcetype=sandfly:users
iseval = 0

[sandfly_credentials]
definition = index=sandfly sourcetype=sandfly:credentials
iseval = 0

###############################################################################
# Notifications, schedules, and scans
###############################################################################

[sandfly_notifications]
definition = index=sandfly sourcetype=sandfly:notifications
iseval = 0

[sandfly_schedules]
definition = index=sandfly sourcetype=sandfly:schedules
iseval = 0

[sandfly_scans]
definition = index=sandfly sourcetype=sandfly:scans
iseval = 0

###############################################################################
# Reporting and saved views
###############################################################################

[sandfly_reports]
definition = index=sandfly sourcetype=sandfly:reports
iseval = 0

[sandfly_savedviews]
definition = index=sandfly sourcetype=sandfly:savedviews
iseval = 0

###############################################################################
# System, audit, and operational logs
###############################################################################

[sandfly_audit]
definition = index=sandfly sourcetype=sandfly:audit
iseval = 0

[sandfly_logs_audit]
definition = index=sandfly sourcetype=sandfly:logs:audit
iseval = 0

[sandfly_logs_error]
definition = index=sandfly sourcetype=sandfly:logs:error
iseval = 0

[sandfly_config]
definition = index=sandfly sourcetype=sandfly:config
iseval = 0

[sandfly_version]
definition = index=sandfly sourcetype=sandfly:version
iseval = 0

[sandfly_license]
definition = index=sandfly sourcetype=sandfly:license
iseval = 0

###############################################################################
# Utility macros (safe helpers)
###############################################################################

[sandfly_timechart_by_day]
definition = timechart span=1d count
iseval = 0

[sandfly_latest_by_field(1)]
definition = stats latest(*) as * by $field$
iseval = 0

###############################################################################
# END OF FILE
###############################################################################
