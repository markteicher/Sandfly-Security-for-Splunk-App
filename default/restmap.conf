# -------------------------------------------------------------------------
# default/restmap.conf
#
# REST endpoint mappings for Sandfly Security for Splunk App
#
# This file defines:
# - Modular input registration
# - Setup handler
# - Validation handler
#
# Data collection is executed by the modular input framework and does not
# require custom REST collection endpoints.
# -------------------------------------------------------------------------


# -------------------------------------------------------------------------
# Modular input REST registration
#
# Required for Splunk to discover and execute sandfly_input.py
# -------------------------------------------------------------------------
[script:sandfly_security]
interval = 0
script = sandfly_input.py
sourcetype = sandfly:json
passAuth = true


# -------------------------------------------------------------------------
# App setup handler
#
# Used by setup.xml to validate connectivity and store configuration
# -------------------------------------------------------------------------
[admin:setup]
match = /servicesNS/nobody/sandfly_security_for_splunk/setup
members = sandfly_setup

[sandfly_setup]
handler = sandfly_setup_handler.setup_handler
requireAuthentication = true
capability = admin_all_objects


# -------------------------------------------------------------------------
# Modular input validation handler
#
# Invoked automatically by Splunk when validating input configuration
# -------------------------------------------------------------------------
[admin:validation]
match = /servicesNS/nobody/sandfly_security_for_splunk/validation
members = sandfly_validation

[sandfly_validation]
handler = sandfly_validation.validate_input
requireAuthentication = true
capability = admin_all_objects
