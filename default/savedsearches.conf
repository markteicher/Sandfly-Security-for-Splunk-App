# -------------------------------------------------------------------------
# default/savedsearches.conf
#
# Sandfly Security for Splunk App
#
# Location:
#   $SPLUNK_HOME/etc/apps/Sandfly_Security_For_Splunk_App/default/savedsearches.conf
#
# Purpose:
# - Define read-only reports, summaries, and dashboard backing searches
# - Provide reusable, named searches for Sandfly data domains
# - Support dashboards without duplicating SPL
#
# Design rules:
# - SEARCH ONLY (no outputlookup, collect, sendemail, etc.)
# - No alerts enabled by default
# - No scheduled execution unless explicitly required
# - Index and sourcetype scoping via macros
#
# -------------------------------------------------------------------------

###############################################################################
# Overview / Executive summaries
###############################################################################

[Sandfly - Alarm Summary]
search = `sandfly_alarms` | stats count by severity
dispatch.earliest_time = -24h
dispatch.latest_time = now
enableSched = 0

[Sandfly - Alarm Trend (24h)]
search = `sandfly_alarms` | timechart span=1h count
dispatch.earliest_time = -24h
dispatch.latest_time = now
enableSched = 0

###############################################################################
# Host inventory
###############################################################################

[Sandfly - Host Inventory]
search = `sandfly_hosts` | stats latest(*) as * by host_id
dispatch.earliest_time = -7d
dispatch.latest_time = now
enableSched = 0

[Sandfly - Hosts by OS]
search = `sandfly_hosts` | stats count by os_name, os_version
dispatch.earliest_time = -7d
dispatch.latest_time = now
enableSched = 0

###############################################################################
# Results / detections
###############################################################################

[Sandfly - Latest Results]
search = `sandfly_results` | sort - _time | head 100
dispatch.earliest_time = -24h
dispatch.latest_time = now
enableSched = 0

[Sandfly - Results by Sandfly Module]
search = `sandfly_results` | stats count by sandfly_name
dispatch.earliest_time = -7d
dispatch.latest_time = now
enableSched = 0

[Sandfly - Results Timeline]
search = `sandfly_results_timeline` | timechart span=1h count
dispatch.earliest_time = -24h
dispatch.latest_time = now
enableSched = 0

###############################################################################
# SSH Hunter
###############################################################################

[Sandfly - SSH Hunter Key Summary]
search = `sandfly_sshhunter_keys` | stats count by key_type
dispatch.earliest_time = -7d
dispatch.latest_time = now
enableSched = 0

[Sandfly - SSH Hunter Users]
search = `sandfly_sshhunter_users` | stats count by username
dispatch.earliest_time = -7d
dispatch.latest_time = now
enableSched = 0

[Sandfly - SSH Hunter Hosts]
search = `sandfly_sshhunter_hosts` | stats count by host
dispatch.earliest_time = -7d
dispatch.latest_time = now
enableSched = 0

###############################################################################
# Scans and schedules
###############################################################################

[Sandfly - Scan Activity]
search = `sandfly_scans` | timechart span=1h count
dispatch.earliest_time = -24h
dispatch.latest_time = now
enableSched = 0

[Sandfly - Active Schedules]
search = `sandfly_schedules` | stats count by status
dispatch.earliest_time = -7d
dispatch.latest_time = now
enableSched = 0

###############################################################################
# Notifications
###############################################################################

[Sandfly - Notification Configurations]
search = `sandfly_notifications` | table name type enabled
dispatch.earliest_time = -30d
dispatch.latest_time = now
enableSched = 0

###############################################################################
# Audit & operational logging
###############################################################################

[Sandfly - Audit Events]
search = `sandfly_logs_audit` | sort - _time
dispatch.earliest_time = -24h
dispatch.latest_time = now
enableSched = 0

[Sandfly - Error Events]
search = `sandfly_logs_error` | sort - _time
dispatch.earliest_time = -24h
dispatch.latest_time = now
enableSched = 0

###############################################################################
# System & platform metadata
###############################################################################

[Sandfly - Platform Version]
search = `sandfly_version` | stats latest(version) as version
dispatch.earliest_time = -30d
dispatch.latest_time = now
enableSched = 0

[Sandfly - License Status]
search = `sandfly_license` | stats latest(*) as *
dispatch.earliest_time = -30d
dispatch.latest_time = now
enableSched = 0

###############################################################################
# END OF FILE
###############################################################################
