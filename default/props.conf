# -------------------------------------------------------------------------
# props.conf
#
# Sandfly Security for Splunk App
#
# Purpose:
# - Define all Sandfly sourcetypes
# - Enforce JSON parsing
# - Apply consistent timestamp handling
# - Ensure safe, predictable event breaking
# - Enable clean downstream logging and searches
#
# Notes:
# - All Sandfly data is JSON
# - No transforms modify raw payloads
# - No index-time field extractions beyond JSON
# -------------------------------------------------------------------------

###############################################################################
# Global defaults for Sandfly JSON events
###############################################################################

[sandfly:*]
SHOULD_LINEMERGE = false
LINE_BREAKER = ([\r\n]+)
TRUNCATE = 0
KV_MODE = json
INDEXED_EXTRACTIONS = json
AUTO_KV_JSON = true
TIME_PREFIX = \"(timestamp|created_date|event_time)\"\s*:\s*\"
TIME_FORMAT = %Y-%m-%dT%H:%M:%S
MAX_TIMESTAMP_LOOKAHEAD = 32
DATETIME_CONFIG = NONE
CHARSET = UTF-8

###############################################################################
# Core Security & Results
###############################################################################

[sandfly:alarms]
category = Security
description = Sandfly alarm results (pass, alert, error)

[sandfly:results]
category = Security
description = Sandfly investigation results stream

[sandfly:results:timeline]
category = Security
description = Timeline view of Sandfly investigation results

[sandfly:results:summary]
category = Security
description = Summary of Sandfly results per host or sandfly

[sandfly:resultprofiles]
category = Security
description = Result profiles and drift analysis data

###############################################################################
# Inventory & Infrastructure
###############################################################################

[sandfly:hosts]
category = Inventory
description = Linux hosts managed by Sandfly

[sandfly:hosts:kernelmodules]
category = Inventory
description = Kernel modules loaded on hosts

[sandfly:hosts:services]
category = Inventory
description = Services detected on hosts

[sandfly:hosts:processes]
category = Inventory
description = Running processes on hosts

[sandfly:hosts:users]
category = Inventory
description = Local users on hosts

[sandfly:hosts:listeners]
category = Inventory
description = Network listeners on hosts

[sandfly:hosts:scheduledtasks]
category = Inventory
description = Scheduled tasks and cron jobs

[sandfly:hosts:lastlog]
category = Inventory
description = Last login activity per host

[sandfly:hosts:loggedinusers]
category = Inventory
description = Currently logged-in users

[sandfly:hosts:info]
category = Inventory
description = Extended host information

###############################################################################
# Sandfly Configuration Objects
###############################################################################

[sandfly:sandflies]
category = Configuration
description = Sandfly detectors and definitions

[sandfly:schedules]
category = Configuration
description = Scheduled Sandfly investigations

[sandfly:savedviews]
category = Configuration
description = Saved views defined in Sandfly

[sandfly:notifications]
category = Configuration
description = Notification definitions

[sandfly:reports]
category = Configuration
description = Sandfly report metadata

[sandfly:sharedurl]
category = Configuration
description = Shared URL access objects

###############################################################################
# SSH Hunter
###############################################################################

[sandfly:sshhunter:summary]
category = SSHHunter
description = SSH Hunter summary data

[sandfly:sshhunter:minisummary]
category = SSHHunter
description = Condensed SSH Hunter summary

[sandfly:sshhunter:keys]
category = SSHHunter
description = SSH keys discovered by SSH Hunter

[sandfly:sshhunter:users]
category = SSHHunter
description = Users associated with SSH keys

[sandfly:sshhunter:hosts]
category = SSHHunter
description = Hosts associated with SSH keys

###############################################################################
# Identity / Auth / Credentials
###############################################################################

[sandfly:users]
category = Identity
description = Sandfly user accounts

[sandfly:users:logins]
category = Identity
description = Successful user login events

[sandfly:users:failed_logins]
category = Identity
description = Failed user login attempts

[sandfly:credentials]
category = Identity
description = Credential objects stored in Sandfly

###############################################################################
# System & Audit
###############################################################################

[sandfly:audit]
category = Audit
description = Sandfly audit trail

[sandfly:logs:audit]
category = Audit
description = Sandfly server audit logs

[sandfly:logs:error]
category = Error
description = Sandfly server error logs

[sandfly:config]
category = System
description = Sandfly system configuration

[sandfly:version]
category = System
description = Sandfly version information

[sandfly:license]
category = System
description = Sandfly license information
