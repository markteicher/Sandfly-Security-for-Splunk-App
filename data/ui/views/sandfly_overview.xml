<!--
=============================================================================
 default/data/ui/views/sandfly_overview.xml
 Sandfly Security for Splunk App
 Overview Dashboard
=============================================================================

Operational overview of Sandfly Security data ingested into Splunk.

Displays host counts, alert/error activity, audit volume,
and ingestion health using defined Sandfly sourcetypes.

=============================================================================
-->

<dashboard version="1.1" theme="light">
  <label>ğŸª± Sandfly Overview</label>

  <!-- =============================================================== -->
  <!-- ROW 1: KEY METRICS                                              -->
  <!-- =============================================================== -->
  <row>

    <panel>
      <title>ğŸ–¥ï¸ Total Hosts</title>
      <single>
        <search>
          <query>
            index=* sourcetype=sandfly:hosts
            | stats count
          </query>
        </search>
        <option name="colorMode">block</option>
        <option name="useColors">true</option>
      </single>
    </panel>

    <panel>
      <title>ğŸš¨ Active Alerts (Last 24h)</title>
      <single>
        <search>
          <query>
            index=* sourcetype=sandfly:results earliest=-24h
            | search result_type="alert"
            | stats count
          </query>
        </search>
        <option name="colorMode">block</option>
        <option name="useColors">true</option>
      </single>
    </panel>

    <panel>
      <title>âŒ Error Results (Last 24h)</title>
      <single>
        <search>
          <query>
            index=* sourcetype=sandfly:results earliest=-24h
            | search result_type="error"
            | stats count
          </query>
        </search>
        <option name="colorMode">block</option>
        <option name="useColors">true</option>
      </single>
    </panel>

    <panel>
      <title>ğŸ“¦ Total Events (24h)</title>
      <single>
        <search>
          <query>
            index=* earliest=-24h sourcetype IN (
              sandfly:hosts,
              sandfly:results,
              sandfly:users,
              sandfly:audit,
              sandfly:resultprofiles,
              sandfly:alerts:email,
              sandfly:notifications
            )
            | stats count
          </query>
        </search>
        <option name="colorMode">block</option>
        <option name="useColors">true</option>
      </single>
    </panel>

  </row>

  <!-- =============================================================== -->
  <!-- ROW 2: RESULT ACTIVITY                                          -->
  <!-- =============================================================== -->
  <row>

    <panel>
      <title>ğŸ“ˆ Results Over Time</title>
      <chart>
        <search>
          <query>
            index=* sourcetype=sandfly:results
            | timechart span=1h count
          </query>
        </search>
        <option name="charting.chart">line</option>
        <option name="charting.legend.placement">bottom</option>
      </chart>
    </panel>

    <panel>
      <title>ğŸ“Š Results by Type (Last 24h)</title>
      <chart>
        <search>
          <query>
            index=* sourcetype=sandfly:results earliest=-24h
            | stats count by result_type
            | sort - count
          </query>
        </search>
        <option name="charting.chart">pie</option>
        <option name="charting.legend.placement">right</option>
      </chart>
    </panel>

  </row>

  <!-- =============================================================== -->
  <!-- ROW 3: OPERATIONAL ACTIVITY                                     -->
  <!-- =============================================================== -->
  <row>

    <panel>
      <title>ğŸ“œ Recent Audit Events</title>
      <table>
        <search>
          <query>
            index=* sourcetype=sandfly:audit
            | sort - _time
            | head 10
          </query>
        </search>
        <option name="wrap">true</option>
      </table>
    </panel>

    <panel>
      <title>ğŸ‘¥ Recent User Activity</title>
      <table>
        <search>
          <query>
            index=* sourcetype=sandfly:users
            | sort - _time
            | head 10
          </query>
        </search>
        <option name="wrap">true</option>
      </table>
    </panel>

  </row>

  <!-- =============================================================== -->
  <!-- ROW 4: INGESTION HEALTH                                         -->
  <!-- =============================================================== -->
  <row>

    <panel>
      <title>ğŸ“Š Events by Sourcetype (24h)</title>
      <table>
        <search>
          <query>
            index=* earliest=-24h sourcetype=sandfly:*
            | stats count by sourcetype
            | sort - count
          </query>
        </search>
      </table>
    </panel>

  </row>

</dashboard>
