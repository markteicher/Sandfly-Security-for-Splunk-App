<!--
=============================================================================
 default/data/ui/views/setup.xml
 Sandfly Security for Splunk App
 Setup Wizard
=============================================================================

SETUP WIZARD

This setup wizard performs the complete configuration of the
Sandfly Security for Splunk App.

From the user’s perspective, the setup wizard:

- Validates connectivity to the Sandfly Security server
- Authenticates using provided credentials
- Verifies required Sandfly API roles based on selected data collectors
- Creates the specified Splunk index if it does not already exist
- Stores credentials securely
- Enables the selected data collectors
- Initializes required checkpoints for streaming data
- Enables operational logging
- Completes setup only on success, or fails with clear errors

No manual configuration is required after this wizard completes.
=============================================================================
-->

<form version="1.1" type="wizard">
  <label>Sandfly Security – Setup</label>

  <description>
    This wizard configures connectivity, storage, logging, and data
    collection for the Sandfly Security for Splunk App.
  </description>

  <!-- =============================================================== -->
  <!-- STEP 1: SANDFLY SERVER CONNECTION                                -->
  <!-- =============================================================== -->
  <fieldset>
    <legend>Sandfly Server Connection</legend>

    <input type="text" token="sandfly_url">
      <label>Sandfly Server URL</label>
      <help>Example: https://sandfly.example.com</help>
      <validation>
        <regex>^(?i)https?://.+</regex>
        <message>URL must begin with http:// or https://</message>
      </validation>
    </input>

    <input type="text" token="sandfly_username">
      <label>Username</label>
    </input>

    <input type="password" token="sandfly_password">
      <label>Password</label>
    </input>
  </fieldset>

  <!-- =============================================================== -->
  <!-- STEP 2: SPLUNK INDEX CONFIGURATION                               -->
  <!-- =============================================================== -->
  <fieldset>
    <legend>Splunk Index</legend>

    <input type="text" token="target_index">
      <label>Target Index</label>
      <help>
        Enter the name of the Splunk index where Sandfly data will be stored.
        The index will be created during setup if it does not already exist.
      </help>
    </input>
  </fieldset>

  <!-- =============================================================== -->
  <!-- STEP 3: OPERATIONAL LOGGING                                     -->
  <!-- =============================================================== -->
  <fieldset>
    <legend>Operational Logging</legend>

    <input type="dropdown" token="enable_logging">
      <label>Enable Operational Logging</label>
      <choice value="true">Enabled</choice>
      <choice value="false">Disabled</choice>
      <default>true</default>
    </input>

    <html>
      <p>
        When enabled, the app writes informational messages to Splunk
        internal logs to support troubleshooting and operational monitoring.
      </p>
    </html>
  </fieldset>

  <!-- =============================================================== -->
  <!-- STEP 4: PROXY CONFIGURATION                                     -->
  <!-- =============================================================== -->
  <fieldset>
    <legend>Proxy Configuration (Optional)</legend>

    <input type="dropdown" token="proxy_mode">
      <label>Proxy Mode</label>
      <choice value="none">No Proxy</choice>
      <choice value="proxy">Proxy (No Authentication)</choice>
      <choice value="proxy_auth">Proxy (With Authentication)</choice>
      <default>none</default>
    </input>

    <input type="text" token="proxy_url" depends="$proxy_mode!=none$">
      <label>Proxy URL</label>
    </input>

    <input type="text" token="proxy_username" depends="$proxy_mode=proxy_auth$">
      <label>Proxy Username</label>
    </input>

    <input type="password" token="proxy_password" depends="$proxy_mode=proxy_auth$">
      <label>Proxy Password</label>
    </input>
  </fieldset>

  <!-- =============================================================== -->
  <!-- STEP 5: DATA COLLECTION SELECTION                                -->
  <!-- =============================================================== -->
  <fieldset>
    <legend>Data Collection</legend>

    <input type="checkbox" token="collectors">
      <label>Select Data to Collect</label>

      <!-- Core inventory -->
      <choice value="hosts">Hosts</choice>
      <choice value="hosts_info">Host Details</choice>
      <choice value="users">Users</choice>
      <choice value="credentials">Credentials</choice>
      <choice value="jumphosts">Jump Hosts</choice>

      <!-- Results / Drift -->
      <choice value="results">Results Stream</choice>
      <choice value="results_timeline">Results Timeline</choice>
      <choice value="results_summary">Results Summary</choice>
      <choice value="resultprofiles">Drift Detection Profiles</choice>

      <!-- Sandflies -->
      <choice value="sandflies">Sandflies</choice>

      <!-- SSH Hunter -->
      <choice value="sshhunter_summary">SSH Hunter Summary</choice>
      <choice value="sshhunter_keys">SSH Hunter Keys</choice>
      <choice value="sshhunter_users">SSH Hunter Users</choice>
      <choice value="sshhunter_hosts">SSH Hunter Hosts</choice>

      <!-- Operations / Admin -->
      <choice value="scan">Scanning</choice>
      <choice value="schedule">Schedules</choice>
      <choice value="alerts_email">Email Alerts</choice>
      <choice value="alerts_syslog">Syslog Alerts</choice>
      <choice value="notifications">Notifications</choice>
      <choice value="audit">Audit Logs</choice>
      <choice value="reports">Reports</choice>

      <default>hosts</default>
      <default>users</default>
      <default>results</default>
      <default>audit</default>
    </input>
  </fieldset>

  <!-- =============================================================== -->
  <!-- STEP 6: COMPLETE SETUP                                          -->
  <!-- =============================================================== -->
  <fieldset>
    <legend>Complete Setup</legend>

    <html>
      <p>
        Click <b>Finish</b> to validate configuration, create required
        resources, enable logging, and begin data collection.
      </p>
    </html>
  </fieldset>

  <submit>
    <label>Finish Setup</label>
  </submit>
</form>
