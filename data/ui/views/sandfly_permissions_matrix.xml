<!--
=============================================================================
 default/data/ui/views/sandfly_permissions_matrix.xml
 Sandfly Security for Splunk App
 API Endpoint Role Security Matrix
=============================================================================

PURPOSE

Displays Sandfly API endpoint access by role, aligned strictly to the
Sandfly Security UI navigation structure.

UI Sections Represented:
- Dashboard
- Results
- Hosts
- Drift Detection
- SSH Hunter
- AI Analysis
- Reports
- Scanning
- Schedules
- Notifications
- Jump Hosts
- Credentials
- Sandflies
- Whitelists
- Settings

Data Source:
- Official Sandfly API Endpoint Role Security Matrix

Roles:
- system
- admin
- user
- api_result_read
- api_scan

=============================================================================
-->

<dashboard version="1.1" theme="light">
  <label>API Endpoint Role Security Matrix</label>

  <!-- =============================================================== -->
  <!-- RESULTS                                                          -->
  <!-- =============================================================== -->
  <row>
    <panel>
      <title>Results</title>
      <table>
        <search>
          <query>
            | makeresults
            | eval method="GET", path="/results/:id", system="Y", admin="Y", user="Y", api_result_read="Y", api_scan="N"
            | append [ | makeresults | eval method="POST", path="/results", system="Y", admin="Y", user="Y", api_result_read="N", api_scan="N" ]
            | append [ | makeresults | eval method="POST", path="/results/timeline", system="Y", admin="Y", user="Y", api_result_read="N", api_scan="N" ]
            | append [ | makeresults | eval method="DELETE", path="/results/:id", system="Y", admin="Y", user="N", api_result_read="N", api_scan="N" ]
            | append [ | makeresults | eval method="GET", path="/resultprofiles", system="Y", admin="Y", user="N", api_result_read="N", api_scan="N" ]
            | table method path system admin user api_result_read api_scan
          </query>
        </search>
        <option name="wrap">true</option>
      </table>
    </panel>
  </row>

  <!-- =============================================================== -->
  <!-- HOSTS                                                            -->
  <!-- =============================================================== -->
  <row>
    <panel>
      <title>Hosts</title>
      <table>
        <search>
          <query>
            | makeresults
            | eval method="GET", path="/hosts", system="Y", admin="Y", user="Y", api_result_read="Y", api_scan="N"
            | append [ | makeresults | eval method="POST", path="/hosts", system="Y", admin="Y", user="N", api_result_read="N", api_scan="N" ]
            | append [ | makeresults | eval method="PUT", path="/hosts/:id", system="Y", admin="Y", user="N", api_result_read="N", api_scan="N" ]
            | append [ | makeresults | eval method="DELETE", path="/hosts/:id", system="Y", admin="Y", user="N", api_result_read="N", api_scan="N" ]
            | table method path system admin user api_result_read api_scan
          </query>
        </search>
      </table>
    </panel>
  </row>

  <!-- =============================================================== -->
  <!-- DRIFT DETECTION                                                  -->
  <!-- =============================================================== -->
  <row>
    <panel>
      <title>Drift Detection</title>
      <table>
        <search>
          <query>
            | makeresults
            | eval method="GET", path="/resultprofiles", system="Y", admin="Y", user="N", api_result_read="N", api_scan="N"
            | append [ | makeresults | eval method="POST", path="/resultprofiles", system="Y", admin="Y", user="N", api_result_read="N", api_scan="N" ]
            | append [ | makeresults | eval method="PUT", path="/resultprofiles/:id", system="Y", admin="Y", user="N", api_result_read="N", api_scan="N" ]
            | append [ | makeresults | eval method="DELETE", path="/resultprofiles/:id", system="Y", admin="Y", user="N", api_result_read="N", api_scan="N" ]
            | table method path system admin user api_result_read api_scan
          </query>
        </search>
      </table>
    </panel>
  </row>

  <!-- =============================================================== -->
  <!-- SCANNING                                                         -->
  <!-- =============================================================== -->
  <row>
    <panel>
      <title>Scanning</title>
      <table>
        <search>
          <query>
            | makeresults
            | eval method="POST", path="/scan", system="Y", admin="Y", user="Y", api_result_read="Y", api_scan="Y"
            | append [ | makeresults | eval method="POST", path="/scan/adhoc", system="Y", admin="Y", user="Y", api_result_read="Y", api_scan="Y" ]
            | table method path system admin user api_result_read api_scan
          </query>
        </search>
      </table>
    </panel>
  </row>

  <!-- =============================================================== -->
  <!-- NOTIFICATIONS                                                    -->
  <!-- =============================================================== -->
  <row>
    <panel>
      <title>Notifications</title>
      <table>
        <search>
          <query>
            | makeresults
            | eval method="GET", path="/notifications", system="Y", admin="Y", user="N", api_result_read="N", api_scan="N"
            | append [ | makeresults | eval method="POST", path="/notifications", system="Y", admin="Y", user="N", api_result_read="N", api_scan="N" ]
            | append [ | makeresults | eval method="PUT", path="/notifications/:id", system="Y", admin="Y", user="N", api_result_read="N", api_scan="N" ]
            | append [ | makeresults | eval method="DELETE", path="/notifications/:id", system="Y", admin="Y", user="N", api_result_read="N", api_scan="N" ]
            | table method path system admin user api_result_read api_scan
          </query>
        </search>
      </table>
    </panel>
  </row>

  <!-- =============================================================== -->
  <!-- CREDENTIALS                                                      -->
  <!-- =============================================================== -->
  <row>
    <panel>
      <title>Credentials</title>
      <table>
        <search>
          <query>
            | makeresults
            | eval method="GET", path="/credentials", system="Y", admin="Y", user="Y", api_result_read="Y", api_scan="N"
            | append [ | makeresults | eval method="POST", path="/credentials/:id", system="Y", admin="Y", user="N", api_result_read="N", api_scan="N" ]
            | append [ | makeresults | eval method="DELETE", path="/credentials/:id", system="Y", admin="Y", user="N", api_result_read="N", api_scan="N" ]
            | table method path system admin user api_result_read api_scan
          </query>
        </search>
      </table>
    </panel>
  </row>

</dashboard>
