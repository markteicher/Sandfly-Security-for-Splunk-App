<!--
=============================================================================
 default/data/ui/views/sandfly_audit_logs.xml
 Sandfly Security for Splunk App
 Audit Logs
=============================================================================

PURPOSE

This view presents Sandfly Security audit activity as raw, chronological
audit records derived directly from the Sandfly API.

DATA SOURCE

- GET /v4/audit
- Sourcetype: sandfly:audit

EXPECTED FIELDS

- id
- timestamp
- username
- record_type
- message
- ip_addr

=============================================================================
-->

<dashboard version="1.1" theme="light">
  <label>Audit Logs</label>

  <!-- =============================================================== -->
  <!-- ROW 1: TOTAL EVENTS                                            -->
  <!-- =============================================================== -->
  <row>
    <panel>
      <title>ðŸ“Š Total Audit Events</title>
      <single>
        <search>
          <query>
            index=* sourcetype=sandfly:audit
            | stats count
          </query>
        </search>
      </single>
    </panel>
  </row>

  <!-- =============================================================== -->
  <!-- ROW 2: DETAILED AUDIT LOG                                      -->
  <!-- =============================================================== -->
  <row>
    <panel>
      <title>ðŸ“‹ Audit Event Log</title>
      <table>
        <search>
          <query>
            index=* sourcetype=sandfly:audit
            | eval audit_time=strptime(timestamp,"%Y-%m-%dT%H:%M:%S.%3NZ")
            | table
                audit_time
                username
                record_type
                message
                ip_addr
                id
            | sort - audit_time
          </query>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">true</option>
        <option name="count">50</option>
      </table>
    </panel>
  </row>

</dashboard>
