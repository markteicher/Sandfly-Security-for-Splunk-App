<!--
=============================================================================
 default/data/ui/views/sandfly_about.xml
 Sandfly Security for Splunk App
 About
=============================================================================

PURPOSE

Displays live Sandfly platform metadata retrieved from the Sandfly API
(/v4/version). No values are hardcoded.

=============================================================================
-->

<dashboard version="1.1" theme="light">
  <label>About Sandfly</label>

  <!-- =============================================================== -->
  <!-- BASE SEARCH: SANDLY VERSION INFO                                -->
  <!-- =============================================================== -->
  <search>
    <query>
      | inputlookup sandfly_version_lookup
    </query>
    <earliest>-5m</earliest>
    <latest>now</latest>
  </search>

  <!-- =============================================================== -->
  <!-- ROW 1: PLATFORM INFORMATION                                     -->
  <!-- =============================================================== -->
  <row>
    <panel>
      <title>Platform Information</title>
      <table>
        <search>
          <query>
            | inputlookup sandfly_version_lookup
            | fields version build_date website copyright
          </query>
        </search>
        <option name="count">1</option>
        <option name="wrap">true</option>
      </table>
    </panel>
  </row>

  <!-- =============================================================== -->
  <!-- ROW 2: CRYPTOGRAPHIC IDENTITY                                   -->
  <!-- =============================================================== -->
  <row>
    <panel>
      <title>Cryptographic Identity</title>
      <table>
        <search>
          <query>
            | inputlookup sandfly_version_lookup
            | fields server_public_key node_public_key
          </query>
        </search>
        <option name="count">1</option>
        <option name="wrap">true</option>
      </table>
    </panel>
  </row>

  <!-- =============================================================== -->
  <!-- ROW 3: APPLICATION METADATA                                     -->
  <!-- =============================================================== -->
  <row>
    <panel>
      <title>Splunk App Metadata</title>
      <html>
        <![CDATA[
        <table>
          <tr>
            <td><strong>Application</strong></td>
            <td>Sandfly Security for Splunk</td>
          </tr>
          <tr>
            <td><strong>Integration Type</strong></td>
            <td>REST API (Sandfly v4)</td>
          </tr>
          <tr>
            <td><strong>Data Format</strong></td>
            <td>JSON</td>
          </tr>
          <tr>
            <td><strong>Splunk Compatibility</strong></td>
            <td>Splunk Enterprise & Splunk Cloud</td>
          </tr>
        </table>
        ]]>
      </html>
    </panel>
  </row>

  <!-- =============================================================== -->
  <!-- ROW 4: ATTRIBUTION                                              -->
  <!-- =============================================================== -->
  <row>
    <panel>
      <title>Attribution</title>
      <html>
        <![CDATA[
        <p>
          Sandfly Security is a registered trademark of Sandfly Security, Ltd.
        </p>
        <p>
          This Splunk App is an independent integration and is not an official
          Sandfly Security product unless explicitly stated otherwise.
        </p>
        ]]>
      </html>
    </panel>
  </row>

  <!-- =============================================================== -->
  <!-- ROW 5: REFERENCES                                               -->
  <!-- =============================================================== -->
  <row>
    <panel>
      <title>References</title>
      <html>
        <![CDATA[
        <ul>
          <li><a href="https://www.sandflysecurity.com" target="_blank">Sandfly Security Website</a></li>
          <li><a href="https://docs.sandflysecurity.com" target="_blank">Sandfly Documentation</a></li>
          <li><a href="https://docs.splunk.com" target="_blank">Splunk Documentation</a></li>
        </ul>
        ]]>
      </html>
    </panel>
  </row>

</dashboard>
