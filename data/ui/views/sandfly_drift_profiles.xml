<!--
=============================================================================
 default/data/ui/views/sandfly_drift_profiles.xml
 Sandfly Security for Splunk App
 Drift Detection Profiles
=============================================================================

PURPOSE

Displays Drift Detection profiles used by Sandfly to detect configuration
and behavioral drift across hosts.

Data Source:
- GET /v4/resultprofiles
- Sourcetype: sandfly:resultprofiles

=============================================================================
-->

<dashboard version="1.1" theme="light">
  <label>üß¨ Drift Detection Profiles</label>

  <!-- =============================================================== -->
  <!-- ROW 1: PROFILE SUMMARY                                         -->
  <!-- =============================================================== -->
  <row>

    <panel>
      <title>üì¶ Total Drift Profiles</title>
      <single>
        <search>
          <query>
            index=* sourcetype=sandfly:resultprofiles
            | stats count
          </query>
        </search>
      </single>
    </panel>

    <panel>
      <title>‚è∏Ô∏è Paused Profiles</title>
      <single>
        <search>
          <query>
            index=* sourcetype=sandfly:resultprofiles
            | search paused=true
            | stats count
          </query>
        </search>
      </single>
    </panel>

    <panel>
      <title>‚ñ∂Ô∏è Scheduled for Scan</title>
      <single>
        <search>
          <query>
            index=* sourcetype=sandfly:resultprofiles
            | search scan_schedule=true
            | stats count
          </query>
        </search>
      </single>
    </panel>

  </row>

  <!-- =============================================================== -->
  <!-- ROW 2: PROFILE INVENTORY                                       -->
  <!-- =============================================================== -->
  <row>
    <panel>
      <title>üìã Drift Profile Inventory</title>
      <table>
        <search>
          <query>
            index=* sourcetype=sandfly:resultprofiles
            | table
                id
                name
                description
                type
                state
                paused
                scan_schedule
                create_date
                hosts_covered_whitelist
                hosts_covered_drift
                total_sandflies
            | sort name
          </query>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">true</option>
      </table>
    </panel>
  </row>

</dashboard>
