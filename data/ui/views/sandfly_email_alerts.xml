<!--
=============================================================================
 default/data/ui/views/sandfly_email_alerts.xml
 Sandfly Security for Splunk App
 Email Alert Configuration
=============================================================================

PURPOSE

Displays configured email alert notification objects retrieved from:

  GET /v4/alerts/email

This view provides visibility into:
- Email alert names
- Recipient lists
- Sender identity
- Mail server configuration
- Authentication usage

This is a configuration visibility view, not an alert activity view.
=============================================================================
-->

<dashboard version="1.1" theme="light">
  <label>Email Alerts</label>

  <!-- =============================================================== -->
  <!-- ROW 1: SUMMARY                                                  -->
  <!-- =============================================================== -->
  <row>
    <panel>
      <title>Total Email Alert Configurations</title>
      <single>
        <search>
          <query>
            index=* sourcetype=sandfly:alerts:email
            | stats count
          </query>
        </search>
        <option name="colorMode">block</option>
        <option name="useColors">true</option>
        <option name="numberPrecision">0</option>
      </single>
    </panel>
  </row>

  <!-- =============================================================== -->
  <!-- ROW 2: EMAIL ALERT DETAILS                                      -->
  <!-- =============================================================== -->
  <row>
    <panel>
      <title>Email Alert Configuration Details</title>
      <table>
        <search>
          <query>
            index=* sourcetype=sandfly:alerts:email
            | spath name
            | spath email_sender
            | spath mail_server
            | spath mail_port
            | spath mail_username
            | spath email_recipients{}
            | eval email_recipients=mvjoin(email_recipients, ", ")
            | table
                name
                email_sender
                email_recipients
                mail_server
                mail_port
                mail_username
            | sort name
          </query>
        </search>
        <option name="wrap">true</option>
        <option name="rowNumbers">false</option>
      </table>
    </panel>
  </row>

</dashboard>
